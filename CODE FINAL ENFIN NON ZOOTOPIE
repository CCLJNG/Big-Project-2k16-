# -*- coding: utf-8 -*-
"""
Created on Sat May 21 16:39:09 2016

@author: user
"""
import pygame #Importation de notre module principal

#def menu(): #seulement si on a le temps....
#    pass

def fille(choix_fille, girlwtf):
    """"
    fonction qui va renvoyer une chaîne de caractère correspondant à la fille
    qu'on voudra séduire
    """
   
    continuer = 1
    
    while continuer != 0:
        for event in pygame.event.get():   #On parcours la liste de tous les événements reçus
            if event.type == pygame.QUIT:     #Si un de ces événements est de type QUIT
                pygame.quit() # on désinitialise tous les modules de Pygame
                quit() # on quitte 
            else:
                if (event.type != pygame.MOUSEBUTTONDOWN): #tant qu'on appuie pas, on continue
                    continue           
                if event.type == pygame.MOUSEBUTTONDOWN and event.button == 1 and 0 < event.pos[1] < 365 and 0 < event.pos[0] <= 213:
                    girlwtf = "clover"
                    continuer = 0
                elif event.type == pygame.MOUSEBUTTONDOWN and event.button == 1 and 0 < event.pos[1] < 365 and 213 < event.pos[0] < 427:
                    girlwtf = "maya"
                    continuer = 0
                elif event.type == pygame.MOUSEBUTTONDOWN and event.button == 1 and 0 < event.pos[1] < 365 and 427 <= event.pos[0] < 640:
                    girlwtf = "alice"
                    continuer = 0

    return girlwtf
      
def effet_choix(n_event, lovejaugeactuelle):
    #n correspond à l'effet du bouton choisi
    #lovejauge correspond a la lovejauge de la meuf choisie
    #Cette fonction fait varier la lovejauge en fonction du choix
    if n_event == 0:
        lovejaugeactuelle += 0
    elif lovejaugeactuelle < 100 and n_event == 1:
        lovejaugeactuelle += 25
    else:
        if lovejaugeactuelle == 0:
            lovejaugeactuelle = 0
        elif lovejaugeactuelle > 0 and lovejaugeactuelle <= 100:
            lovejaugeactuelle -= 25
        
    return lovejaugeactuelle #retourne la veleur de lovejaugeactuelle soit, un int

def image_lovejauge(lovejauge): #fonction renvoyant une image qui correspond à la valeur de lovejauge
    if lovejauge == 0:
        lovepic = pygame.image.load("lovejauge_0.png").convert_alpha()
    elif lovejauge == 25:
        lovepic = pygame.image.load("lovejauge_25.png").convert_alpha()
    elif lovejauge == 50:
        lovepic = pygame.image.load("lovejauge_50.png").convert_alpha()
    elif lovejauge == 75:
        lovepic = pygame.image.load("lovejauge_75.png").convert_alpha()
    else:
        lovepic = pygame.image.load("lovejauge_100.png").convert_alpha()
        
    return lovepic
    
    
def choix(n_event, lovejaugeactuelle, girl_pic, fenetre): #CA CEST LA MACHINE A SMOOTHIE OK 
    #n_event est le numero du dialogue 
     #on ajoute le dialogue de la fille
    i = 1
    choix_affiches = 0
    suite = 0
    continuer = 1
    while i == 1:
        
        #sinon ça continue sans nous parce qu'on est pas en train de cliquer sur un bouton        
        #fenetre.blit(test_pic, (0,0))
        #pygame.event.set_allowed(pygame.MOUSEBUTTONDOWN)
        for event in pygame.event.get():            
            while continuer != 0:
    
                for event in pygame.event.get():   #On parcours la liste de tous les événements reçus
                    if event.type == pygame.QUIT:     #Si un de ces événements est de type QUIT
                        pygame.quit() # on quitte
                        quit()
                    else:
                        if (event.type != pygame.MOUSEBUTTONDOWN): #tant qu'on appuie pas, on continue
                            continue           
                        print("choix_affiches=" , choix_affiches)
                        print(event)
                        print("suite=", suite)
                        print("lovejaugeactuelle=", lovejaugeactuelle)
                        
                        if suite != 2:
                            if (event.type == pygame.MOUSEBUTTONDOWN) and (event.button == 1) and (380 < event.pos[1] < 480) and (540 < event.pos[0] < 640): #c'est le bouton coeur pour avancer dans le dialogue
                                fenetre.blit(n_event[0], (0,0))    
                                pygame.display.flip()
                                suite = 1
                                if suite == 1:
                                    if (event.type == pygame.MOUSEBUTTONDOWN) and (event.button == 1) and (380 < event.pos[1] < 480) and (540 < event.pos[0] < 640):
                                        fenetre.blit(n_event[4], (0,0)) #si on appuie sur "next", l'image avec les choix s'affiche
                                        pygame.display.flip()
                                        choix_affiches = 1 
                                        suite = 2
                                    else:
                                        continue
                            else:
                                continue
                            
                            
                        if choix_affiches == 1:
                            if event.type == pygame.MOUSEBUTTONDOWN and event.button == 1 and 50 < event.pos[1] < 100 and 50 < event.pos[0] < 430:
                                lovejauge = effet_choix(n_event[1], lovejaugeactuelle)
                                i = 0
                            elif event.type == pygame.MOUSEBUTTONDOWN and event.button == 1 and 150 < event.pos[1] < 200 and 50 < event.pos[0] < 430:
                                lovejauge = effet_choix(n_event[2], lovejaugeactuelle)
                                i = 0
                            elif event.type == pygame.MOUSEBUTTONDOWN and event.button == 1 and 250 < event.pos[1] < 300 and 50 < event.pos[0] < 430:
                                lovejauge = effet_choix(n_event[3], lovejaugeactuelle)
                                i = 0
                            else:
                                continue
                        pygame.display.flip() 
                    continuer = 0
            
    return lovejauge
    
def main():
    
    pygame.init() #on initialise les modules importés de pygame
   
    #Ouverture de la fenêtre Pygame
    fenetre = pygame.display.set_mode((640, 480))
    
    #menu() CA ON VERRA SELON NOTRE TIME
        
    #girl = choix_fille() # on choisit la fille à séduire

    #Chargement et collage du fond
    fond = pygame.image.load("fond_classe.png").convert()

    girlwtf = pygame.image.load("test.png").convert() #à supprimer après
    
    choix_fille = pygame.image.load("choix_fille.png").convert()#on charge l'image de toutes les filles
    fenetre.blit(choix_fille, (0,0))

    #Rafraîchissement de l'écran, essentiel !
    pygame.display.flip()
    i = 0

    blabla = 0 # pour pas qu'il skip



    #Boucle infinie
    continuer = 1
    while continuer != 0:
        for event in pygame.event.get():   #On parcours la liste de tous les événements reçus
            if event.type == pygame.QUIT: 
                continuer = 0 #Si un de ces événements est de type QUIT
                #pygame.quit()      #On arrête la boucle
            else:
                
                girl = fille(choix_fille, girlwtf) # on choisit la fille
                fenetre.blit(fond, (0,0))
                #girl = "clover" #temporaire 
                if girl == "clover":
                    girl_pic = pygame.image.load("clover_happy.png").convert_alpha()
                    #on charge le photo de CLOVER
                    
                    #on va charger toutes les images de dialogue et les choix possibles pour les 6 interactions
                    dialogue_mec = pygame.image.load("dialogue_c_0.png").convert_alpha()
                    pic_1 = pygame.image.load("dialogue_c_1.png").convert_alpha()
                    pic_1_2 = pygame.image.load("choix_c_1.png").convert_alpha()
                    n_event_1 = (pic_1, 1, 2, 0, pic_1_2)
                    pic_2 = pygame.image.load("dialogue_c_2.png").convert_alpha()
                    pic_2_2 = pygame.image.load("choix_c_2.png").convert_alpha()
                    n_event_2 = (pic_2, 1, 0, 2, pic_2_2)                    
                    pic_3 = pygame.image.load("dialogue_c_3.png").convert_alpha()
                    pic_3_2 = pygame.image.load("choix_c_3.png").convert_alpha()
                    n_event_3 = (pic_3, 1, 0, 2, pic_3_2)
                    pic_4 = pygame.image.load("dialogue_c_4.png").convert_alpha()
                    pic_4_2 = pygame.image.load("choix_c_4.png").convert_alpha()
                    n_event_4 = (pic_4, 2, 1, 0, pic_4_2)
                    pic_5 = pygame.image.load("dialogue_c_5.png").convert_alpha()
                    pic_5_2 = pygame.image.load("choix_c_5.png").convert_alpha()
                    n_event_5 = (pic_5, 1, 2, 0, pic_5_2)
                    pic_6 = pygame.image.load("dialogue_c_6.png").convert_alpha()
                    pic_6_2 = pygame.image.load("choix_c_6.png").convert_alpha()
                    n_event_6 = (pic_6, 0, 1, 2, pic_6_2)
                    blabla = 1
                elif girl == "maya":
                    dialogue_mec = pygame.image.load("dialogue_m_0.png").convert_alpha()
                    girl_pic = pygame.image.load("maya_happy.png").convert_alpha()
                    pic_1 = pygame.image.load("dialogue_m_1.png").convert_alpha()
                    pic_1_2 = pygame.image.load("choix_m_1.png").convert_alpha()
                    n_event_1 = (pic_1, 1, 2, 0, pic_1_2)
                    pic_2 = pygame.image.load("dialogue_m_2.png").convert_alpha()
                    pic_2_2 = pygame.image.load("choix_m_2.png").convert_alpha()
                    n_event_2 = (pic_2, 1, 0, 2, pic_2_2)
                    pic_3 = pygame.image.load("dialogue_m_3.png").convert_alpha()
                    pic_3_2 = pygame.image.load("choix_m_3.png").convert_alpha()
                    n_event_3 = (pic_3, 1, 0, 2, pic_3_2)
                    pic_4 = pygame.image.load("dialogue_m_4.png").convert_alpha()
                    pic_4_2 = pygame.image.load("choix_m_4.png").convert_alpha()
                    n_event_4 = (pic_4, 2, 1, 0, pic_4_2)
                    pic_5 = pygame.image.load("dialogue_m_5.png").convert_alpha()
                    pic_5_2 = pygame.image.load("choix_m_5.png").convert_alpha()
                    n_event_5 = (pic_5, 1, 2, 0, pic_5_2)
                    pic_6 = pygame.image.load("dialogue_m_6.png").convert_alpha()
                    pic_6_2 = pygame.image.load("choix_m_6.png").convert_alpha()
                    n_event_6 = (pic_6, 0, 1, 2, pic_6_2)
                    blabla = 1
                elif girl == "alice":
                    dialogue_mec = pygame.image.load("dialogue_a_0.png").convert_alpha()
                    girl_pic = pygame.image.load("alice_happy.png").convert_alpha()
                    pic_1 = pygame.image.load("dialogue_a_1.png").convert_alpha()
                    pic_1_2 = pygame.image.load("choix_a_1.png").convert_alpha()
                    n_event_1 = (pic_1, 1, 2, 0, pic_1_2)
                    pic_2 = pygame.image.load("dialogue_a_2.png").convert_alpha()
                    pic_2_2 = pygame.image.load("choix_a_2.png").convert_alpha()
                    n_event_2 = (pic_2, 1, 0, 2, pic_2_2)
                    pic_3 = pygame.image.load("dialogue_a_3.png").convert_alpha()
                    pic_3_2 = pygame.image.load("choix_a_3.png").convert_alpha()
                    n_event_3 = (pic_3, 1, 0, 2, pic_3_2)
                    pic_4 = pygame.image.load("dialogue_a_4.png").convert_alpha()
                    pic_4_2 = pygame.image.load("choix_a_4.png").convert_alpha()
                    n_event_4 = (pic_4, 2, 1, 0, pic_4_2)
                    pic_5 = pygame.image.load("dialogue_a_5.png").convert_alpha()
                    pic_5_2 = pygame.image.load("choix_a_5.png").convert_alpha()
                    n_event_5 = (pic_5, 1, 2, 0, pic_5_2)
                    pic_6 = pygame.image.load("dialogue_a_6.png").convert_alpha()
                    pic_6_2 = pygame.image.load("choix_a_6.png").convert_alpha()
                    n_event_6 = (pic_6, 0, 1, 2, pic_6_2)
                    blabla = 1
                if blabla == 1:    
                    lovejaugeactuelle = 0 #on initialise notre love jauge à 0, normal!
                    #perso = pygame.image.load(girl_).convert_alpha()
                    fenetre.blit(girl_pic, (0,0)) #on ajoute à la fenetre, l'image de la fille
                    #fenetre.blit(test_pic, (0,0))
                    pygame.display.flip()
                   
                    while i < 6:
                    #for i in range(0,6):
                        #Chargement et collage du personnage
                        #Pour les 6 interactions on appelle la fonction "smoothie"
                        if i == 0:
                            fenetre.blit(dialogue_mec, (0,0)) #tout d'abord, on place le dialogue du garçon
                            n_event = n_event_1                
                            pygame.display.flip()
                            i += 1
                        elif i == 1:
                            n_event = n_event_2
                            i += 1
                        elif i == 2:
                            n_event = n_event_3
                            i += 1
                        elif i == 3:
                            n_event = n_event_4
                            i += 1
                        elif i == 4:
                            n_event = n_event_5
                            i += 1
                        elif i == 5:
                            n_event = n_event_6
                            i += 1
    
                        lovejaugeactuelle = choix(n_event, lovejaugeactuelle, girl_pic, fenetre) # ca c'est la fonction smoothie
                        print ("i=", i)
                        lovepict = image_lovejauge(lovejaugeactuelle)
                        fenetre.blit(lovepict, (0,0))
                        pygame.display.flip()
                    
    pygame.display.flip()
    pygame.quit()
    quit()

main()
